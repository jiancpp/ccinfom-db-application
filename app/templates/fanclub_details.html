{% extends "base.html" %}

{% block title %}{{ fanclub_name }} Details{% endblock %}

{% block content %}

    {# --- BACK BUTTON BAR --- #}
    <div style="margin-bottom: 1.5rem;">
        <a href="{{ url_for('main_routes.fanclubs') }}" 
           class="btn btn-small btn-outline" 
           style="text-decoration: none; padding: 5px 12px; font-size: 0.85rem; color: #555;">
            &larr; Back to Fanclub List
        </a>
    </div>

    {# HEADER AND ACTION BUTTONS #}
    <div style="margin-bottom: 4rem; 
                display: flex; 
                justify-content: space-between; 
                align-items: flex-end; /* Align actions to the bottom of the title block */
                gap: 20px;">

        {# TITLE BLOCK (MUST BE CONTAINED FOR FLEX LAYOUT) #}
        <div class="header-titles">
            <h1 style="color: #764ba2; margin-top: 0.5rem; margin-bottom: 0.1rem; font-size: 3rem; white-space: nowrap;">
                ‚ú® {{ fanclub.fanclub_name }}
            </h1>
            
            <p style="font-size: 1.3rem; font-weight: 300; color: #555; margin-top: 0; white-space: nowrap;">
                {{ fanclub.artist_name }} Fan Community
            </p>
        </div>
        
        {# View List Button and Join/Leave Button #}
        <div class="action-buttons" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            
            {# View Members Button #}
            <a href="{{ url_for('main_routes.fanclub_members', fanclub_id=fanclub.fanclub_id) }}" 
               class="btn btn-secondary-soft" 
               style="background-color: #a0a8e0; 
                      color: white; 
                      padding: 10px 18px; 
                      border-radius: 8px; 
                      text-decoration: none; 
                      font-weight: 500; font-size: 0.95rem;">
                View Fanclub Members &rarr;
            </a>

            {% if fanclub.is_member %}
                {# Leave Button #}
                <a href="{{ url_for('main_routes.leave_fanclub', fanclub_id=fanclub.fanclub_id) }}" 
                   class="btn btn-action-danger" 
                   style="background-color: #ff6b6b; color: white; padding: 10px 22px; border-radius: 8px; font-weight: 600; font-size: 0.95rem;">Leave Fanclub</a>
            {% else %}
                {# Join Button #}
                <a href="{{ url_for('main_routes.join_fanclub', fanclub_id=fanclub.fanclub_id) }}" 
                   class="btn btn-action-primary" 
                   style="background-color: #764ba2; 
                          color: white; 
                          padding: 10px 22px; border-radius: 8px; font-weight: 600; font-size: 0.95rem;">Join Fanclub</a>
            {% endif %}
        </div>
    </div>
    
    
    {# MAIN CONTENT #}
    <div class="main-content-flow" style="display: flex; flex-direction: column; gap: 4rem;">
        
        {# RELATED MERCHANDISE SECTION (Prominent Card Grid) #}
        <section>
            <h2 style="color: #764ba2; border-bottom: 2px solid #eee; padding-bottom: 0.5rem; margin-bottom: 2rem;">
                üõçÔ∏è Exclusive Merchandise ({{ fanclub.merchandise | length }})
            </h2>
            
            {% if fanclub.merchandise %}
                <div class="merch-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 2rem;">
                    {% for merch in fanclub.merchandise %}
                        <div class="merch-card" 
                             style="text-align: center; 
                                    padding: 1.5rem 1rem; 
                                    background: #fff; 
                                    border-radius: 12px; 
                                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);">
                            
                            {# MERCHANDISE NAME #}
                            <h5 style="margin-top: 0; margin-bottom: 0.5rem; color: #333; font-size: 1.1rem;">{{ merch.merch_name }}</h5>
                            
                            {# MERCHANDISE PRICE #}
                            <p style="color: #4CAF50; font-weight: 700; font-size: 1.2rem; margin-bottom: 1rem;">${{ merch.price }}</p>
                            
                            {# View Button #}
                            <a href="/merchandise/{{ merch.merch_id }}" class="btn btn-small" 
                               style="background: #764ba2; color: white; padding: 8px 15px; border-radius: 6px; font-weight: 500;">View</a>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state" style="padding: 1.5rem; background: #fff8e1; border-radius: 8px;">
                    <p style="color: #b38800;">No exclusive merchandise available right now. Check back soon!</p>
                </div>
            {% endif %}
        </section>

        {# --- 2. RELATED EVENTS SECTION --- #}
        <section>
            <h2 style="color: #764ba2; border-bottom: 2px solid #eee; padding-bottom: 0.5rem; margin-bottom: 2rem;">
                üìÖ Upcoming Fanclub Events ({{ fanclub.events | length }})
            </h2>
            
            {% if fanclub.events %}
                <div class="event-list">
                    {% for event in fanclub.events %}
                        <div class="event-item-card" 
                             style="margin-bottom: 1.5rem; padding: 1.5rem; 
                                    background: #f0f8ff; 
                                    border-radius: 10px; 
                                    border-left: 6px solid #00bcd4; 
                                    display: flex; justify-content: space-between; align-items: center; 
                                    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);">
                            <div style="flex-grow: 1;">
                                <h4 style="margin-top: 0; margin-bottom: 0.25rem; color: #333;">{{ event.event_name }}</h4>
                                <p style="color: #555; margin: 0; font-weight: 500;">
                                    {% if event.start_date != event.end_date %}
                                        <span class="date">{{ event.start_date }}</span> to 
                                        <span class="date">{{ event.end_date }}</span>
                                    {% else %}
                                        <span class="date">{{ event.start_date }}</span>
                                    {% endif %}
                                </p>
                            </div>
                            {# Details Button #}
                            <a href="{{ url_for('main_routes.buy_ticket', event_id=event.event_id) }}" class="btn btn-small btn-primary" 
                               style="background: #00bcd4; color: white; padding: 10px 18px; border-radius: 6px; font-weight: 500;">Buy Tickets</a>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state" style="padding: 1.5rem; background: #fff8e1; border-radius: 8px;">
                    <p style="color: #b38800;">No upcoming fanclub-exclusive events scheduled. Stay tuned!</p>
                </div>
            {% endif %}
        </section>
        
    </div>

{% endblock %}
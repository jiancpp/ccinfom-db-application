{% extends "base.html" %}

{% block title %}Your Shopping Cart | K-Sync Merch{% endblock %}

{% block content %}
    <header style="margin-bottom: 2rem;">
        <h1>üõçÔ∏è Your K-Pop Cart</h1>
        <p style="color: #666;">Review your items before proceeding to payment.</p>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% endwith %}

    <div class="cart-container">

        {% if cart_items %}
            
            <table class="table" style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
                <thead>
                    <tr style="border-bottom: 2px solid #5C6773;">
                        <th style="padding: 1rem 0.5rem; text-align: left;">Item</th>
                        <th style="padding: 1rem 0.5rem; text-align: center;">Artist/Club</th>
                        <th style="padding: 1rem 0.5rem; text-align: center;">Price</th>
                        <th style="padding: 1rem 0.5rem; text-align: center;">Qty</th>
                        <th style="padding: 1rem 0.5rem; text-align: right;">Subtotal</th>
                        <th style="padding: 1rem 0.5rem; text-align: center;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in cart_items %}
                        <tr style="border-bottom: 1px dashed #eee;">
                            <td style="padding: 1rem 0.5rem;"><strong>{{ item.name }}</strong></td>
                            <td style="padding: 1rem 0.5rem; text-align: center;">{{ item.artist }}</td>
                            <td style="padding: 1rem 0.5rem; text-align: center;">P{{ "%.2f"|format(item.price) }}</td>
                            <td style="padding: 1rem 0.5rem; text-align: center;">
                                {1}
                            </td>
                            <td style="padding: 1rem 0.5rem; text-align: right;"><strong>P{{ "%.2f"|format(item.subtotal) }}</strong></td>
                            <td style="padding: 1rem 0.5rem; text-align: center;">
                                <a href="{{ url_for('main_routes.remove_from_cart', item_id=item.id) }}" 
                                   class="btn-action" 
                                   style="color: red; text-decoration: none;">‚ùå Remove</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
                <div style="width: 350px; padding: 1.5rem; background-color: #f7f9fc; border-radius: 8px; border: 1px solid #eee;">
                    
                    <p style="font-size: 1.1rem; margin-bottom: 5px; display: flex; justify-content: space-between;">
                        <span>Total Items:</span>
                        <span style="font-weight: bold;">{{ item_count }}</span>
                    </p>
                    
                    <p style="font-size: 1.1rem; margin-bottom: 15px; display: flex; justify-content: space-between;">
                        <span>Shipping:</span>
                        <span style="font-weight: bold; color: #4CAF50;">FREE</span>
                    </p>
                    
                    <hr style="border-top: 2px solid #ddd;">

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                        <h3 style="margin: 0; font-size: 1.5rem;">Total Price:</h3>
                        <h3 style="margin: 0; color: #1e88e5; font-size: 1.8rem; font-weight: bold;">
                            P{{ "%.2f"|format(cart_total) }}
                        </h3>
                    </div>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 2.5rem;">

                <a href="{{ url_for('main_routes.merchandise') }}" 
                   class="btn-back"
                   style="text-decoration: none; padding: 10px 15px; border: 1px solid #ccc; border-radius: 5px;">
                    ‚Üê Continue Shopping
                </a>
            
                <a href="{{ url_for('main_routes.clear_cart') }}" 
                   class="btn-clear"
                   style="margin-right: 1rem; text-decoration: none; padding: 10px 15px; background-color: #f0f0f0; border-radius: 5px;">
                    Empty Cart
                </a>
            
                <form method="POST" action="{{ url_for('main_routes.place_order') }}" style="margin: 0;">
                    <button type="submit" class="btn-checkout" 
                        style="padding: 12px 20px; background-color: #4CAF50; color: white; border-radius: 5px; font-weight: bold;">
                        Place Final Order ‚Üí
                    </button>
                </form>
            
            </div>            
            


        {% else %}
        <div class="empty-state" style="text-align: center; padding: 5rem; border: 1px dashed #ccc; border-radius: 8px; background-color: #fafafa; margin-bottom: 10px;">
            <p style="font-size: 1.8rem; color: #555;">üò≠ Your K-Pop cart is empty!</p>
            <a href="{{ url_for('main_routes.merchandise') }}" class="btn-shop" 
               style="margin-top: 2rem; display: inline-block; text-decoration: none; padding: 12px 25px; background-color: #1e88e5; color: white; border-radius: 5px; font-weight: bold;">
                Go to Shop
            </a>
        </div>
        {% endif %}

    </div>

{% endblock %}